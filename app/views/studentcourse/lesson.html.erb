<% content_for :title, "Watch Lesson | iSchool" %>
<%= render 'shared/navbar' %>
    <div class="container-vdo" style="padding-top:37px;">
        <h1 class="video_head">All Lessons of <%= @course.name %> </h1>
        <div class="my_video_container">
            <div id="my_video_player">                            
                <video controls poster="/assets/img1.jpg" class="myvideo" id="myvideo">
                    <source src="" type="video/mp4">
                    <source src="" type="video/mp4">
                </video>
            </div>
    
        </div>

        <div class="vdo-scrollBox">
            <h4 style="text-align:center;"><%= @course.name %> Playlist </h4>
            <% @course.lessions.each do |i|%>
                <div class="mybox">
                    <img src="/assets/img1.jpg">
                    <div class="mybox-content">
                        <h3 class="h3_heading"> <%= i.l_name %> </h3>
                        <a href="<%= url_for(i.lession_video) %>" class="watch-vdo-btn">Watch</a>
                    </div>
                    <p style="text-align:center;"><%= i.l_name %></p>
                </div>
            <%end%>
        </div>
    </div>


<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br> 
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>


<!-- ###########################javascript for vidoe Player################ -->
<script type="text/javascript">
let anchors = document.querySelectorAll('div .watch-vdo-btn');
let links = [...anchors];

for (let i=0; i<links.length; i++) {
    links[i].onclick = handler;
}
function handler(e) {
    e.preventDefault();
    let videotarget = this.getAttribute("href");
    let filename = videotarget.substr(0, videotarget.lastIndexOf('.'));
    let video = document.getElementById("myvideo");
    video.removeAttribute("poster");
    let source = document.querySelectorAll("#my_video_player video source");
    source[0].src = filename + ".mp4";
    source[1].src = filename + ".m4v";
    video.load();
    video.play();
}
</script>
